<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.376">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<title>Computational Methods in R - 2&nbsp; Using and Building Functions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./assignments.html" rel="next">
<link href="./beyond-dataframes.html" rel="prev">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 20,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
</head>
<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./course-notes.html">Course Notes</a></li><li class="breadcrumb-item"><a href="./using-and-building-functions.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using and Building Functions</span></a></li></ol></nav>
        <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><header id="title-block-header" class="quarto-title-block default page-columns page-full"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./course-notes.html">Course Notes</a></li><li class="breadcrumb-item"><a href="./using-and-building-functions.html"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using and Building Functions</span></a></li></ol></nav><div class="quarto-title-banner page-columns page-full">
    <div class="quarto-title column-body">
      <div class="quarto-title-block"><div><h1 class="title"><span id="sec-using-and-building-functions" class="quarto-section-identifier"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using and Building Functions</span></span></h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
                      </div>
  </div>
    
  
  <div class="quarto-title-meta">

      
    
      
    </div>
    
  
  </header><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="./">Computational Methods in R</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Overview</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./course-notes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Course Notes</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./beyond-dataframes.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Beyond Dataframes</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./using-and-building-functions.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Using and Building Functions</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a href="./assignments.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Assignments</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./hw1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Homework 1</span></span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#overview" id="toc-overview" class="nav-link active" data-scroll-target="#overview"><span class="header-section-number">2.1</span> Overview</a></li>
  <li>
<a href="#r-function-basics---components" id="toc-r-function-basics---components" class="nav-link" data-scroll-target="#r-function-basics---components"><span class="header-section-number">2.2</span> R Function Basics - Components</a>
  <ul class="collapse">
<li><a href="#formals" id="toc-formals" class="nav-link" data-scroll-target="#formals"><span class="header-section-number">2.2.1</span> Formals</a></li>
  <li><a href="#body" id="toc-body" class="nav-link" data-scroll-target="#body"><span class="header-section-number">2.2.2</span> Body</a></li>
  <li><a href="#environment" id="toc-environment" class="nav-link" data-scroll-target="#environment"><span class="header-section-number">2.2.3</span> Environment</a></li>
  </ul>
</li>
  <li>
<a href="#creating-functions" id="toc-creating-functions" class="nav-link" data-scroll-target="#creating-functions"><span class="header-section-number">2.3</span> Creating Functions</a>
  <ul class="collapse">
<li><a href="#calling-a-function" id="toc-calling-a-function" class="nav-link" data-scroll-target="#calling-a-function"><span class="header-section-number">2.3.1</span> Calling a Function</a></li>
  <li><a href="#automating-procedures" id="toc-automating-procedures" class="nav-link" data-scroll-target="#automating-procedures"><span class="header-section-number">2.3.2</span> Automating procedures</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content quarto-banner-title-block" id="quarto-document-content"><section id="overview" class="level2" data-number="2.1"><h2 data-number="2.1" class="anchored" data-anchor-id="overview">
<span class="header-section-number">2.1</span> Overview</h2>
<p>This section will discuss R functions. Functions are the engines that define how to DO things with your data objects in R. If data objects are the “nouns”, then functions are the “verbs” of the R language.</p>
<p>Why build functions?</p>
<ol type="1">
<li><p>Because it is fun (for us nerdy people).</p></li>
<li><p>Because we find ourselves doing the same task multiple times throughout our code, and realize that each iteration is mostly the same process using slightly different values or variables.</p></li>
<li><p>Because we want to avoid copy/paste related errors.</p></li>
<li><p>Because we want to make our code more readable.</p></li>
</ol>
<p>This will discuss the basic structure and components of a function, how a function is created, passing parameters implicitly versus explicitly in a function call, name masking in nested environments, and infix operators.</p>
<p>Below are links to supplementary resources about building functions in R:</p>
<ul>
<li><a href="http://adv-r.had.co.nz/Functions.html">Advanced R Functions Chapter</a></li>
<li><a href="https://r4ds.hadley.nz/functions">Additional Functions Reading from R for Data Science E-book</a></li>
</ul></section><section id="r-function-basics---components" class="level2" data-number="2.2"><h2 data-number="2.2" class="anchored" data-anchor-id="r-function-basics---components">
<span class="header-section-number">2.2</span> R Function Basics - Components</h2>
<blockquote class="blockquote">
<p>``To understand computations in R, two slogans are helpful: Everything that exists is an object. Everything that happens is a function call.’’ — John Chambers</p>
</blockquote>
<p>Formals: The defined parameters of a function. Think of these as the set of data objects and options that can be defined by the programmer when a function is used.</p>
<p>For these exercises we will consider the following functions:</p>
<ul>
<li>
<code><a href="https://rdrr.io/r/base/mean.html">mean()</a></code> from base R</li>
<li>
<code><a href="https://ggplot2.tidyverse.org/reference/ggplot.html">ggplot()</a></code> from the ggplot2 package</li>
<li>
<code>%&gt;%</code> piping symbol from the dplyr package</li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/function-calls_e7da165f65a7c8d2c9bd2a2c3fb2b4ec">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidyverse.tidyverse.org">tidyverse</a></span><span class="op">)</span></span>
<span></span>
<span><span class="co"># a function without parentheses prints what it is</span></span>
<span><span class="co"># -&gt; with the parenthesis, it tells R to run it</span></span>
<span><span class="va">mean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (x, ...) 
UseMethod("mean")
&lt;bytecode: 0x7fda9fd08578&gt;
&lt;environment: namespace:base&gt;</code></pre>
</div>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">ggplot</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (data = NULL, mapping = aes(), ..., environment = parent.frame()) 
{
    UseMethod("ggplot")
}
&lt;bytecode: 0x7fda6da13ac0&gt;
&lt;environment: namespace:ggplot2&gt;</code></pre>
</div>
</div>
<p>Pipe</p>
<ul>
<li><p>This is actually quite a complex function (yes, a function) (things like this are called infix operator). Infix operators go in between arguments.</p></li>
<li><p>Can surround an infix operator with tick marks to see what this function is actually doing.</p></li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/pipe_422fee37ce226f524428a97bba725900">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># infix operator: pipe</span></span>
<span><span class="va">`%&gt;%`</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>function (lhs, rhs) 
{
    lhs &lt;- substitute(lhs)
    rhs &lt;- substitute(rhs)
    kind &lt;- 1L
    env &lt;- parent.frame()
    lazy &lt;- TRUE
    .External2(magrittr_pipe)
}
&lt;bytecode: 0x7fda8d9cc3e0&gt;
&lt;environment: namespace:magrittr&gt;</code></pre>
</div>
</div>
<ul>
<li>Another example is <code>+</code>. This is a primitive function, which just means that R doesn’t evaluate it. It sends it down and is evaluated in C (because it is more efficient).</li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/addition_087dc7848cf2177a866289d37edefa7b">
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># infix operator as function</span></span>
<span><span class="fu">`+`</span><span class="op">(</span><span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 5</code></pre>
</div>
</div>
<section id="formals" class="level3" data-number="2.2.1"><h3 data-number="2.2.1" class="anchored" data-anchor-id="formals">
<span class="header-section-number">2.2.1</span> Formals</h3>
<p>What are the formals for these functions?</p>
<ul>
<li>
<code>?formals()</code>: Formals are things that we define to change the behavior of the outcome.</li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/formals_527dc84a90537b6d3b14982677d98659">
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># view formals</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/formals.html">formals</a></span><span class="op">(</span><span class="va">`%&gt;%`</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$lhs


$rhs</code></pre>
</div>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/formals.html">formals</a></span><span class="op">(</span><span class="va">mean</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$x


$...</code></pre>
</div>
</div>
<ul>
<li><p><code>...</code> are a special (very flexible, catch all) type of formal argument that we can put non-necessary arguments.</p></li>
<li><p>For example, with mean <code>mean(x, na.rm = TRUE)</code>, this saves the value <code>TRUE</code> to na.rm argument and saves that value as the function is run.</p></li>
</ul></section><section id="body" class="level3" data-number="2.2.2"><h3 data-number="2.2.2" class="anchored" data-anchor-id="body">
<span class="header-section-number">2.2.2</span> Body</h3>
<p>The lines of code that will be run when the function is called. The body uses the formals and usually returns a result of some kind.</p>
<div class="cell" data-hash="using-and-building-functions_cache/html/body_bf27354e8b86ef8bb473791352ee9b05">
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># body()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/body.html">body</a></span><span class="op">(</span><span class="va">`+`</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>NULL</code></pre>
</div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; returns null because the function isn't run in R</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/body.html">body</a></span><span class="op">(</span><span class="va">ggplot</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>{
    UseMethod("ggplot")
}</code></pre>
</div>
</div>
<ul>
<li>Note that the code in the body is never commented because R strips away the comments when running to make its more compact. When we write functions, we add comments so the humans know what it does, but when it is stored they are removed to take up less space.</li>
</ul></section><section id="environment" class="level3" data-number="2.2.3"><h3 data-number="2.2.3" class="anchored" data-anchor-id="environment">
<span class="header-section-number">2.2.3</span> Environment</h3>
<p>The environment is the group of named objects which functions have access to. In other words, it is where the function will retrieve named objects used to execute the code from the body.</p>
<ul>
<li><p>The global environment is everything that we have loaded in, created ourselves or in base R.</p></li>
<li><p><code><a href="https://rdrr.io/r/base/ls.html">ls()</a></code> tells you what you have created / assigned in the global environment (to get, set, test for and create environments, use <code><a href="https://rdrr.io/r/base/environment.html">environment()</a></code>).</p></li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/global-environment_d0710f71eadff833ada2486d4afbbe1f">
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># ?environment()</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "has_annotations"</code></pre>
</div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">y</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/ls.html">ls</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] "has_annotations" "y"              </code></pre>
</div>
</div>
<ul>
<li>When calling functions, they have access to the names of objects in the namespace. It can map the name to where the object is stored. So it retrieves values through the names, so names are very powerful and why we can do computation work that is readable.</li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/namespaces_8606eb5b4b2715d1121839eb60c5b6a4">
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># y is now in the namespace, so we have access to it</span></span>
<span><span class="co"># -&gt; the name gets mapped to its value</span></span>
<span><span class="va">y</span><span class="op">*</span><span class="fl">2</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1]  2  4  6  8 10</code></pre>
</div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">iris</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  Sepal.Length Sepal.Width Petal.Length Petal.Width Species
1          5.1         3.5          1.4         0.2  setosa
2          4.9         3.0          1.4         0.2  setosa
3          4.7         3.2          1.3         0.2  setosa
4          4.6         3.1          1.5         0.2  setosa
5          5.0         3.6          1.4         0.2  setosa
6          5.4         3.9          1.7         0.4  setosa</code></pre>
</div>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; we were able to find this because head and iris are a namespace in the global environment</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<ul>
<li>When we load a library, we are loading a namespace that has access to all the function names and dataset names in the library (package). Everything is a named object (objects, functions, etc.) and they are saved somewhere. The environment is where R finds the object.</li>
</ul>
<p>Local namespaces</p>
<ul>
<li><p>When a function is called, a local namespace is created within the global environment (like a subspace of the global environment).</p></li>
<li><p>When code is run in this local environment, R has access to all objects contained in the global environment.</p></li>
<li><p>The primary difference is that when the local namespace is created, the formal argument names and their defined values are written into the local namespace. If these objects already exist in the global environment, they are overwritten locally while the function code is running. This is referred to as <strong>name masking</strong>.</p></li>
<li><p>After the function code has completed running, the local environment is deleted. Thus, the local environment of a function is both nested in the global environment and is temporary.</p></li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/local-arguments_44f146609d299ecf9138f77c01c44545">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># when we call the mean function, x is defined locally but not globally</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span>x <span class="op">=</span> <span class="va">y</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
</section></section><section id="creating-functions" class="level2" data-number="2.3"><h2 data-number="2.3" class="anchored" data-anchor-id="creating-functions">
<span class="header-section-number">2.3</span> Creating Functions</h2>
<p>To create a function you must define the formals and body in using the <code>function()</code> function, and assign the definition to a name.</p>
<ul>
<li><p>Below we are giving a function as a value to the function name.</p></li>
<li><p>Functions are first class objects (they store expressions, rather than data values).</p></li>
<li><p>If there is a set of things we want to do, we can wrap a bunch of code into an expression by wrapping in curly brackets, then R thinks about it as one thing.</p></li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/defining-functions_cc40d6b8a686e065e5652fae3feb5786">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># writing functions</span></span>
<span><span class="va">function_name</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formal_arguments_go_here</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="co"># code body expression goes here</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/formals.html">formals</a></span><span class="op">(</span><span class="va">function_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$formal_arguments_go_here</code></pre>
</div>
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/body.html">body</a></span><span class="op">(</span><span class="va">function_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code><a href="https://rdrr.io/r/base/Paren.html">{
}</a></code></pre>
</div>
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/environment.html">environment</a></span><span class="op">(</span><span class="va">function_name</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;environment: R_GlobalEnv&gt;</code></pre>
</div>
</div>
<p>Also note, <code>function()</code> is a very weird function, since the body argument goes outside the parentheses! Technically even the example above is a real function (albeit a boring one).</p>
<p>Better example of simple function for adding up two numbers.</p>
<ul>
<li><p>Give functions a name that indicate what it does (intuitive names help a great deal with readable code).</p></li>
<li>
<p>Style guide: Can use the assignment arrow <code>&lt;-</code> for anytime something will be saved to the global environment (data values and functions), but within a function we can use <code>=</code> because it is only found locally and is temporary.</p>
<ul>
<li>
<code>&lt;&lt;-</code> Assigns values from a local environment (like a function call) and saves it in the global environment (this is a really bad idea because it could overwrite something that you already have in the global environment)</li>
</ul>
</li>
<li><p>Returning values: Functions implicitly return the last thing computed. So it is often a good idea to be explicit about what to return.</p></li>
</ul>
<div class="cell" data-hash="using-and-building-functions_cache/html/defining-functions-assignment_f9ab824909487ebef8e130fbe28d6fcc">
<div class="sourceCode" id="cb34"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># write function add two numbers</span></span>
<span><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">val</span> <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">my_sum</span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># bad idea</span></span>
<span><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">val</span> <span class="op">&lt;&lt;-</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="co"># val isn't in the global environment</span></span>
<span><span class="fu">my_sum</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
</div>
<p>More complex functions: In a legitimate function, to have our function behave differently, we can use some if and else statements that are usually triggered by a yes / no or true / false.</p>
<div class="cell" data-hash="using-and-building-functions_cache/html/unnamed-chunk-12_e953af59f7f28f417e4735329b79bce0">
<div class="sourceCode" id="cb38"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># label: defining-functions-ifs</span></span>
<span></span>
<span><span class="co"># now trying to do something cool (and / or breaking it)</span></span>
<span><span class="co"># -&gt; on rare occasions, add some random error to the sum</span></span>
<span><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">mischief</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">mischief</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">val</span> <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">val</span> <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.02</span>,<span class="fl">.96</span>,<span class="fl">.02</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">val</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># run the function 100 times using specified values for the arguments</span></span>
<span><span class="co"># -&gt; not using the X in our function call</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span>, <span class="va">my_sum</span>, x <span class="op">=</span> <span class="fl">1</span>, y <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  [1] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3
 [38] 3 3 3 2 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 3 4 3 3 3 3 3 3 3 3 3 3 3 3
 [75] 3 3 3 3 3 3 3 3 3 3 3 3 3 3 2 3 3 3 4 3 3 3 3 3 3 3</code></pre>
</div>
<div class="sourceCode" id="cb40"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># equivalent to</span></span>
<span><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fl">100</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">my_sum</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 2
[1] 3
[1] 3
[1] 2
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 2
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 2
[1] 3
[1] 4
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 2
[1] 3
[1] 3
[1] 4
[1] 3
[1] 3
[1] 2
[1] 3
[1] 3
[1] 3
[1] 3
[1] 3
[1] 4
[1] 3
[1] 3
[1] 3
[1] 3
[1] 2
[1] 3
[1] 3
[1] 3</code></pre>
</div>
</div>
<p>Can return something more complex than just a data value by returning lists. Functions that output lists are kinda the next step of complex computing ideas.</p>
<div class="cell" data-hash="using-and-building-functions_cache/html/unnamed-chunk-13_1ca69c081419ddc821d04c818d5654c1">
<div class="sourceCode" id="cb42"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># label: defining-functions-return-list</span></span>
<span></span>
<span><span class="co"># modify function to return a list with multiple objects in it</span></span>
<span><span class="va">my_sum</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span>, <span class="va">mischief</span> <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">mischief</span> <span class="op">==</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">{</span></span>
<span>    <span class="va">val</span> <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span></span>
<span>  <span class="op">}</span> <span class="kw">else</span> <span class="op">{</span></span>
<span>    <span class="va">val</span> <span class="op">=</span> <span class="va">x</span> <span class="op">+</span> <span class="va">y</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">1</span>,<span class="fl">0</span>,<span class="fl">1</span><span class="op">)</span>, size <span class="op">=</span> <span class="fl">1</span>, prob <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">.02</span>,<span class="fl">.96</span>,<span class="fl">.02</span><span class="op">)</span><span class="op">)</span></span>
<span>  <span class="op">}</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>value <span class="op">=</span> <span class="va">val</span>,</span>
<span>              mischief <span class="op">=</span> <span class="va">mischief</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">my_sum</span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>$value
[1] 3

$mischief
[1] TRUE</code></pre>
</div>
</div>
<p><code><a href="https://rdrr.io/r/base/lapply.html">sapply()</a></code> is a function that calls other functions in an iterative way (really efficient for loop).</p>
<section id="calling-a-function" class="level3" data-number="2.3.1"><h3 data-number="2.3.1" class="anchored" data-anchor-id="calling-a-function">
<span class="header-section-number">2.3.1</span> Calling a Function</h3>
<p>To call a function, you simply use its name and define any required formal arguments. Typically this is done within a set of parentheses directly following the function name. Only a few special cases break from that pattern.</p>
<p>What is more important to focus on is <strong>if</strong> and <strong>how</strong> we define the arguments. We may choose to define nothing in the arguments and the function might still work.</p>
<div class="cell" data-hash="using-and-building-functions_cache/html/args-null_0e713db6c77882dfac583c943e03528b">
<div class="sourceCode" id="cb44"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># write function that has no arguments to simply return this hardcoded value</span></span>
<span><span class="va">no_arg</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu">no_arg</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># -&gt; so it will generate an error if we tried to give it an argument that isn't defined in the function</span></span>
<span><span class="fu">no_arg</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in no_arg(x = 20): unused argument (x = 20)</code></pre>
</div>
</div>
<p>Typically these are made more flexible using dots <code>...</code>. All this does is put the values into the local namespace and continues running the function. These are optional arguments.</p>
<div class="cell" data-hash="using-and-building-functions_cache/html/args-dots_311f926bb88067a96440c446ab0db58a">
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># define function wtih ... formal</span></span>
<span><span class="va">no_arg2</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="va">x</span> <span class="op">=</span> <span class="fl">10</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># functions works with no arguments</span></span>
<span><span class="fu">no_arg2</span><span class="op">(</span><span class="op">)</span> </span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># and now with arguments</span></span>
<span><span class="co"># -&gt; it initializes the value of x, but then  overwrites the value of x internally</span></span>
<span><span class="fu">no_arg2</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
</div>
<p>For “optional” arguments (arguments that sometimes matters and sometimes don’t matter), we should define them as formal parameters with some default values. This way we can override them if we wanted to.</p>
<div class="cell" data-hash="using-and-building-functions_cache/html/args-defaults_eb59379f399928265f743aea11dc2206">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># add default value to argument</span></span>
<span><span class="co"># -&gt; now it behaves typically how we want, but can change them if we want</span></span>
<span><span class="va">no_arg3</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">x</span> <span class="op">=</span> <span class="fl">10</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">x</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="co"># this is the behavior we typically will want</span></span>
<span><span class="fu">no_arg3</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 10</code></pre>
</div>
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">no_arg3</span><span class="op">(</span>x <span class="op">=</span> <span class="fl">20</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 20</code></pre>
</div>
</div>
<p>The more important characteristics of function calls are related to how we define our arguments: implicitly and explicitly. If we rely on the default ordering of the arguements, then we are calling the arguments <em>implicitly</em>. If we refer to the argument by it’s name while defining the values, then we are calling the argument <em>explicitly</em>. Often we use a mix of these methods, but it is important to be aware of how and why we choose to define our arguments.</p>
<p>A function runs through all of the named arguments, then goes in order for the unnamed arguments.</p>
<div class="cell" data-hash="using-and-building-functions_cache/html/arg_exp_implicit_f14943d27732a432bba4f216f99b883c">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># all of the following are equivalent</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">5</span>, na.rm <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode" id="cb60"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span>na.rm <span class="op">=</span> <span class="cn">TRUE</span>, x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3</code></pre>
</div>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># the following is NOT equivalent</span></span>
<span><span class="co"># -&gt; it is expecting a numeric first</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="cn">TRUE</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">5</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-error">
<pre><code>Error in mean.default(TRUE, 1:5): 'trim' must be numeric of length one</code></pre>
</div>
</div>
<p>Possible convention: Implicitly give the function data values first, then use explicit calling for the options (this will still be readable because the function name will indicate what it’s going to do with the data values).</p>
</section><section id="automating-procedures" class="level3" data-number="2.3.2"><h3 data-number="2.3.2" class="anchored" data-anchor-id="automating-procedures">
<span class="header-section-number">2.3.2</span> Automating procedures</h3>
<p>The following example demonstrates code that would be better served by constructing a function to accomplish the task.</p>
<div class="cell" data-hash="using-and-building-functions_cache/html/example-change-to-functions_4e906cd848286b2f3e9fabd0c451881e">
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># take the following olive oil data and standardize the columns</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">pdfCluster</span><span class="op">)</span> <span class="co"># for the data</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">)</span> <span class="co"># ?oliveoil</span></span>
<span></span>
<span><span class="co"># start with a dataframe where create the z-scores for palmitic acid, then add the rest </span></span>
<span><span class="va">oo_standardized</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  palmitic <span class="op">=</span> <span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="st">"palmitic"</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="st">"palmitic"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="st">"palmitic"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">oo_standardized</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>    palmitic
1 -0.9297061
2 -0.8525970
3 -1.9024672
4 -1.5762364
5 -1.0720614
6 -1.9024672</code></pre>
</div>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># do this better with a function, rather than copy and paste and change column names</span></span>
<span><span class="va">oo_standardized2</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span></span>
<span>  oleic <span class="op">=</span> <span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="st">"oleic"</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="st">"oleic"</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="st">"oleic"</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="va">oo_standardized2</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>      oleic
1 1.2598296
2 0.9789102
3 1.9744494
4 1.5777122
5 1.1316909
6 1.5087145</code></pre>
</div>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># write function to take a variable name and return the standardized column</span></span>
<span><span class="va">oo_stand</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">varname</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="va">varname</span><span class="op">]</span><span class="op">-</span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="va">varname</span><span class="op">]</span><span class="op">)</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">[</span>,<span class="va">varname</span><span class="op">]</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/utils/head.html">head</a></span><span class="op">(</span><span class="fu">oo_stand</span><span class="op">(</span><span class="st">"palmitic"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.9297061 -0.8525970 -1.9024672 -1.5762364 -1.0720614 -1.9024672</code></pre>
</div>
<div class="sourceCode" id="cb70"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># loop over all column names with sapply()</span></span>
<span><span class="va">oo_standardized3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span>X <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span><span class="op">(</span><span class="va">oliveoil</span><span class="op">)</span><span class="op">[</span><span class="fl">3</span><span class="op">:</span><span class="fl">10</span><span class="op">]</span>, FUN <span class="op">=</span> <span class="va">oo_stand</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>


<!-- -->

</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  const viewSource = window.document.getElementById('quarto-view-source') ||
                     window.document.getElementById('quarto-code-tools-source');
  if (viewSource) {
    const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
    viewSource.addEventListener("click", function(e) {
      if (sourceUrl) {
        // rstudio viewer pane
        if (/\bcapabilities=\b/.test(window.location)) {
          window.open(sourceUrl);
        } else {
          window.location.href = sourceUrl;
        }
      } else {
        const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
        modal.show();
      }
      return false;
    });
  }
  function toggleCodeHandler(show) {
    return function(e) {
      const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
      for (let i=0; i<detailsSrc.length; i++) {
        const details = detailsSrc[i].parentElement;
        if (show) {
          details.open = true;
        } else {
          details.removeAttribute("open");
        }
      }
      const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
      const fromCls = show ? "hidden" : "unhidden";
      const toCls = show ? "unhidden" : "hidden";
      for (let i=0; i<cellCodeDivs.length; i++) {
        const codeDiv = cellCodeDivs[i];
        if (codeDiv.classList.contains(fromCls)) {
          codeDiv.classList.remove(fromCls);
          codeDiv.classList.add(toCls);
        } 
      }
      return false;
    }
  }
  const hideAllCode = window.document.getElementById("quarto-hide-all-code");
  if (hideAllCode) {
    hideAllCode.addEventListener("click", toggleCodeHandler(false));
  }
  const showAllCode = window.document.getElementById("quarto-show-all-code");
  if (showAllCode) {
    showAllCode.addEventListener("click", toggleCodeHandler(true));
  }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        for (let i = 0; i < 2; i++) {
          container.appendChild(note.children[i].cloneNode(true));
        }
        return container.innerHTML
      } else {
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      return note.innerHTML;
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        console.log("RESIZE");
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./beyond-dataframes.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Beyond Dataframes</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./assignments.html" class="pagination-link">
        <span class="nav-page-text">Assignments</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb71" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a><span class="fu"># Using and Building Functions {#sec-using-and-building-functions}</span></span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: load-prereqs</span></span>
<span id="cb71-7"><a href="#cb71-7" aria-hidden="true" tabindex="-1"></a><span class="co">#| echo: false</span></span>
<span id="cb71-8"><a href="#cb71-8" aria-hidden="true" tabindex="-1"></a><span class="co">#| message: false</span></span>
<span id="cb71-9"><a href="#cb71-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-10"><a href="#cb71-10" aria-hidden="true" tabindex="-1"></a><span class="co"># knitr options</span></span>
<span id="cb71-11"><a href="#cb71-11" aria-hidden="true" tabindex="-1"></a><span class="fu">source</span>(<span class="st">"_common.R"</span>)</span>
<span id="cb71-12"><a href="#cb71-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-13"><a href="#cb71-13" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-14"><a href="#cb71-14" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-15"><a href="#cb71-15" aria-hidden="true" tabindex="-1"></a><span class="fu">## Overview </span></span>
<span id="cb71-16"><a href="#cb71-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-17"><a href="#cb71-17" aria-hidden="true" tabindex="-1"></a>This section will discuss R functions. Functions are the engines that define how to DO things with your data objects in R. If data objects are the "nouns", then functions are the "verbs" of the R language. </span>
<span id="cb71-18"><a href="#cb71-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-19"><a href="#cb71-19" aria-hidden="true" tabindex="-1"></a>Why build functions?</span>
<span id="cb71-20"><a href="#cb71-20" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-21"><a href="#cb71-21" aria-hidden="true" tabindex="-1"></a><span class="ss">1. </span>Because it is fun (for us nerdy people).</span>
<span id="cb71-22"><a href="#cb71-22" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-23"><a href="#cb71-23" aria-hidden="true" tabindex="-1"></a><span class="ss">2. </span>Because we find ourselves doing the same task multiple times throughout our code, and realize that each iteration is mostly the same process using slightly different values or variables. </span>
<span id="cb71-24"><a href="#cb71-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-25"><a href="#cb71-25" aria-hidden="true" tabindex="-1"></a><span class="ss">3. </span>Because we want to avoid copy/paste related errors.</span>
<span id="cb71-26"><a href="#cb71-26" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-27"><a href="#cb71-27" aria-hidden="true" tabindex="-1"></a><span class="ss">4. </span>Because we want to make our code more readable.</span>
<span id="cb71-28"><a href="#cb71-28" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-29"><a href="#cb71-29" aria-hidden="true" tabindex="-1"></a>This will discuss the basic structure and components of a function, how a function is created, passing parameters implicitly versus explicitly in a function call, name masking in nested environments, and infix operators.</span>
<span id="cb71-30"><a href="#cb71-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-31"><a href="#cb71-31" aria-hidden="true" tabindex="-1"></a>Below are links to supplementary resources about building functions in R: </span>
<span id="cb71-32"><a href="#cb71-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-33"><a href="#cb71-33" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Advanced R Functions Chapter</span><span class="co">](http://adv-r.had.co.nz/Functions.html)</span></span>
<span id="cb71-34"><a href="#cb71-34" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Additional Functions Reading from R for Data Science E-book</span><span class="co">](https://r4ds.hadley.nz/functions)</span></span>
<span id="cb71-35"><a href="#cb71-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-36"><a href="#cb71-36" aria-hidden="true" tabindex="-1"></a><span class="fu">## R Function Basics - Components </span></span>
<span id="cb71-37"><a href="#cb71-37" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-38"><a href="#cb71-38" aria-hidden="true" tabindex="-1"></a><span class="at">&gt;``To understand computations in R, two slogans are helpful: Everything that exists is an object. Everything that happens is a function call.''</span></span>
<span id="cb71-39"><a href="#cb71-39" aria-hidden="true" tabindex="-1"></a><span class="at">  — John Chambers</span></span>
<span id="cb71-40"><a href="#cb71-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-41"><a href="#cb71-41" aria-hidden="true" tabindex="-1"></a>Formals: The defined parameters of a function. Think of these as the set of data objects and options that can be defined by the programmer when a function is used.</span>
<span id="cb71-42"><a href="#cb71-42" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-43"><a href="#cb71-43" aria-hidden="true" tabindex="-1"></a>For these exercises we will consider the following functions:</span>
<span id="cb71-44"><a href="#cb71-44" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-45"><a href="#cb71-45" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`mean()`</span> from base R</span>
<span id="cb71-46"><a href="#cb71-46" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ggplot()`</span> from the ggplot2 package</span>
<span id="cb71-47"><a href="#cb71-47" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`%&gt;%`</span> piping symbol from the dplyr package</span>
<span id="cb71-48"><a href="#cb71-48" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-51"><a href="#cb71-51" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-52"><a href="#cb71-52" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: function-calls </span></span>
<span id="cb71-53"><a href="#cb71-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-54"><a href="#cb71-54" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(tidyverse)</span>
<span id="cb71-55"><a href="#cb71-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-56"><a href="#cb71-56" aria-hidden="true" tabindex="-1"></a><span class="co"># a function without parentheses prints what it is</span></span>
<span id="cb71-57"><a href="#cb71-57" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; with the parenthesis, it tells R to run it</span></span>
<span id="cb71-58"><a href="#cb71-58" aria-hidden="true" tabindex="-1"></a>mean</span>
<span id="cb71-59"><a href="#cb71-59" aria-hidden="true" tabindex="-1"></a>ggplot</span>
<span id="cb71-60"><a href="#cb71-60" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-61"><a href="#cb71-61" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-62"><a href="#cb71-62" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-63"><a href="#cb71-63" aria-hidden="true" tabindex="-1"></a>Pipe</span>
<span id="cb71-64"><a href="#cb71-64" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-65"><a href="#cb71-65" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>This is actually quite a complex function (yes, a function) (things like this are called infix operator). Infix operators go in between arguments.</span>
<span id="cb71-66"><a href="#cb71-66" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-67"><a href="#cb71-67" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Can surround an infix operator with tick marks to see what this function is actually doing.</span>
<span id="cb71-68"><a href="#cb71-68" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-71"><a href="#cb71-71" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-72"><a href="#cb71-72" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: pipe</span></span>
<span id="cb71-73"><a href="#cb71-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-74"><a href="#cb71-74" aria-hidden="true" tabindex="-1"></a><span class="co"># infix operator: pipe</span></span>
<span id="cb71-75"><a href="#cb71-75" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span></span>
<span id="cb71-76"><a href="#cb71-76" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-77"><a href="#cb71-77" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-78"><a href="#cb71-78" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-79"><a href="#cb71-79" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Another example is <span class="in">`+`</span>. This is a primitive function, which just means that R doesn't evaluate it. It sends it down and is evaluated in C (because it is more efficient).</span>
<span id="cb71-80"><a href="#cb71-80" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-83"><a href="#cb71-83" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-84"><a href="#cb71-84" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: addition</span></span>
<span id="cb71-85"><a href="#cb71-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-86"><a href="#cb71-86" aria-hidden="true" tabindex="-1"></a><span class="co"># infix operator as function</span></span>
<span id="cb71-87"><a href="#cb71-87" aria-hidden="true" tabindex="-1"></a><span class="st">`</span><span class="at">+</span><span class="st">`</span>(<span class="dv">2</span>, <span class="dv">3</span>)</span>
<span id="cb71-88"><a href="#cb71-88" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-89"><a href="#cb71-89" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-90"><a href="#cb71-90" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-91"><a href="#cb71-91" aria-hidden="true" tabindex="-1"></a><span class="fu">### Formals</span></span>
<span id="cb71-92"><a href="#cb71-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-93"><a href="#cb71-93" aria-hidden="true" tabindex="-1"></a>What are the formals for these functions?</span>
<span id="cb71-94"><a href="#cb71-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-95"><a href="#cb71-95" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`?formals()`</span>: Formals are things that we define to change the behavior of the outcome.</span>
<span id="cb71-96"><a href="#cb71-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-99"><a href="#cb71-99" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-100"><a href="#cb71-100" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: formals</span></span>
<span id="cb71-101"><a href="#cb71-101" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-102"><a href="#cb71-102" aria-hidden="true" tabindex="-1"></a><span class="co"># view formals</span></span>
<span id="cb71-103"><a href="#cb71-103" aria-hidden="true" tabindex="-1"></a><span class="fu">formals</span>(<span class="st">`</span><span class="at">%&gt;%</span><span class="st">`</span>)</span>
<span id="cb71-104"><a href="#cb71-104" aria-hidden="true" tabindex="-1"></a><span class="fu">formals</span>(mean)</span>
<span id="cb71-105"><a href="#cb71-105" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-106"><a href="#cb71-106" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-107"><a href="#cb71-107" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-108"><a href="#cb71-108" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`...`</span> are a special (very flexible, catch all) type of formal argument that we can put non-necessary arguments.</span>
<span id="cb71-109"><a href="#cb71-109" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-110"><a href="#cb71-110" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>For example, with mean <span class="in">`mean(x, na.rm = TRUE)`</span>, this saves the value <span class="in">`TRUE`</span> to na.rm  argument and saves that value as the function is run.</span>
<span id="cb71-111"><a href="#cb71-111" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-112"><a href="#cb71-112" aria-hidden="true" tabindex="-1"></a><span class="fu">### Body </span></span>
<span id="cb71-113"><a href="#cb71-113" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-114"><a href="#cb71-114" aria-hidden="true" tabindex="-1"></a>The lines of code that will be run when the function is called. The body uses the formals and usually returns a result of some kind.</span>
<span id="cb71-115"><a href="#cb71-115" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-118"><a href="#cb71-118" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-119"><a href="#cb71-119" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: body</span></span>
<span id="cb71-120"><a href="#cb71-120" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-121"><a href="#cb71-121" aria-hidden="true" tabindex="-1"></a><span class="co"># body()</span></span>
<span id="cb71-122"><a href="#cb71-122" aria-hidden="true" tabindex="-1"></a><span class="fu">body</span>(<span class="st">`</span><span class="at">+</span><span class="st">`</span>)</span>
<span id="cb71-123"><a href="#cb71-123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-124"><a href="#cb71-124" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; returns null because the function isn't run in R</span></span>
<span id="cb71-125"><a href="#cb71-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-126"><a href="#cb71-126" aria-hidden="true" tabindex="-1"></a><span class="fu">body</span>(ggplot)</span>
<span id="cb71-127"><a href="#cb71-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-128"><a href="#cb71-128" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-129"><a href="#cb71-129" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-130"><a href="#cb71-130" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Note that the code in the body is never commented because R strips away the comments when running to make its more compact. When we write functions, we add comments so the humans know what it does, but when it is stored they are removed to take up less space.</span>
<span id="cb71-131"><a href="#cb71-131" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-132"><a href="#cb71-132" aria-hidden="true" tabindex="-1"></a><span class="fu">### Environment </span></span>
<span id="cb71-133"><a href="#cb71-133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-134"><a href="#cb71-134" aria-hidden="true" tabindex="-1"></a>The environment is the group of named objects which functions have access to. In other words, it is where the function will retrieve named objects used to execute the code from the body.</span>
<span id="cb71-135"><a href="#cb71-135" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-136"><a href="#cb71-136" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The global environment is everything that we have loaded in, created ourselves or in base R.</span>
<span id="cb71-137"><a href="#cb71-137" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-138"><a href="#cb71-138" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="in">`ls()`</span> tells you what you have created / assigned in the global environment (to get, set, test for and create environments, use <span class="in">`environment()`</span>).</span>
<span id="cb71-139"><a href="#cb71-139" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-142"><a href="#cb71-142" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-143"><a href="#cb71-143" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: global-environment</span></span>
<span id="cb71-144"><a href="#cb71-144" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-145"><a href="#cb71-145" aria-hidden="true" tabindex="-1"></a><span class="co"># ?environment()</span></span>
<span id="cb71-146"><a href="#cb71-146" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span>
<span id="cb71-147"><a href="#cb71-147" aria-hidden="true" tabindex="-1"></a>y <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span></span>
<span id="cb71-148"><a href="#cb71-148" aria-hidden="true" tabindex="-1"></a><span class="fu">ls</span>()</span>
<span id="cb71-149"><a href="#cb71-149" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-150"><a href="#cb71-150" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-151"><a href="#cb71-151" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-152"><a href="#cb71-152" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When calling functions, they have access to the names of objects in the namespace. It can map the name to where the object is stored. So it retrieves values through the names, so names are very powerful and why we can do computation work that is readable. </span>
<span id="cb71-153"><a href="#cb71-153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-156"><a href="#cb71-156" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-157"><a href="#cb71-157" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: namespaces</span></span>
<span id="cb71-158"><a href="#cb71-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-159"><a href="#cb71-159" aria-hidden="true" tabindex="-1"></a><span class="co"># y is now in the namespace, so we have access to it</span></span>
<span id="cb71-160"><a href="#cb71-160" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; the name gets mapped to its value</span></span>
<span id="cb71-161"><a href="#cb71-161" aria-hidden="true" tabindex="-1"></a>y<span class="sc">*</span><span class="dv">2</span></span>
<span id="cb71-162"><a href="#cb71-162" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-163"><a href="#cb71-163" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(iris)</span>
<span id="cb71-164"><a href="#cb71-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-165"><a href="#cb71-165" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; we were able to find this because head and iris are a namespace in the global environment</span></span>
<span id="cb71-166"><a href="#cb71-166" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-167"><a href="#cb71-167" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-168"><a href="#cb71-168" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-169"><a href="#cb71-169" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When we load a library, we are loading a namespace that has access to all the function names and dataset names in the library (package). Everything is a named object (objects, functions, etc.) and they are saved somewhere. The environment is where R finds the object.</span>
<span id="cb71-170"><a href="#cb71-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-171"><a href="#cb71-171" aria-hidden="true" tabindex="-1"></a>Local namespaces</span>
<span id="cb71-172"><a href="#cb71-172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-173"><a href="#cb71-173" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When a function is called, a local namespace is created within the global environment (like a subspace of the global environment).</span>
<span id="cb71-174"><a href="#cb71-174" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-175"><a href="#cb71-175" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>When code is run in this local environment, R has access to all objects contained in the global environment.</span>
<span id="cb71-176"><a href="#cb71-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-177"><a href="#cb71-177" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>The primary difference is that when the local namespace is created, the formal argument names and their defined values are written into the local namespace. If these objects already exist in the global environment, they are overwritten locally while the function code is running. This is referred to as **name masking**.</span>
<span id="cb71-178"><a href="#cb71-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-179"><a href="#cb71-179" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>After the function code has completed running, the local environment is deleted. Thus, the local environment of a function is both nested in the global environment and is temporary.</span>
<span id="cb71-180"><a href="#cb71-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-183"><a href="#cb71-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-184"><a href="#cb71-184" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: local-arguments</span></span>
<span id="cb71-185"><a href="#cb71-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-186"><a href="#cb71-186" aria-hidden="true" tabindex="-1"></a><span class="co"># when we call the mean function, x is defined locally but not globally</span></span>
<span id="cb71-187"><a href="#cb71-187" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x =</span> y)</span>
<span id="cb71-188"><a href="#cb71-188" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-189"><a href="#cb71-189" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-190"><a href="#cb71-190" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-191"><a href="#cb71-191" aria-hidden="true" tabindex="-1"></a><span class="fu">## Creating Functions</span></span>
<span id="cb71-192"><a href="#cb71-192" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-193"><a href="#cb71-193" aria-hidden="true" tabindex="-1"></a>To create a function you must define the formals and body in using the <span class="in">`function()`</span> function, and assign the definition to a name.</span>
<span id="cb71-194"><a href="#cb71-194" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-195"><a href="#cb71-195" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Below we are giving a function as a value to the function name.</span>
<span id="cb71-196"><a href="#cb71-196" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-197"><a href="#cb71-197" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Functions are first class objects (they store expressions, rather than data values).</span>
<span id="cb71-198"><a href="#cb71-198" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-199"><a href="#cb71-199" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>If there is a set of things we want to do, we can wrap a bunch of code into an expression by wrapping in curly brackets, then R thinks about it as one thing.</span>
<span id="cb71-200"><a href="#cb71-200" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-203"><a href="#cb71-203" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-204"><a href="#cb71-204" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: defining-functions</span></span>
<span id="cb71-205"><a href="#cb71-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-206"><a href="#cb71-206" aria-hidden="true" tabindex="-1"></a><span class="co"># writing functions</span></span>
<span id="cb71-207"><a href="#cb71-207" aria-hidden="true" tabindex="-1"></a>function_name <span class="ot">&lt;-</span> <span class="cf">function</span>(formal_arguments_go_here) {</span>
<span id="cb71-208"><a href="#cb71-208" aria-hidden="true" tabindex="-1"></a>  <span class="co"># code body expression goes here</span></span>
<span id="cb71-209"><a href="#cb71-209" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-210"><a href="#cb71-210" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-211"><a href="#cb71-211" aria-hidden="true" tabindex="-1"></a><span class="fu">formals</span>(function_name)</span>
<span id="cb71-212"><a href="#cb71-212" aria-hidden="true" tabindex="-1"></a><span class="fu">body</span>(function_name)</span>
<span id="cb71-213"><a href="#cb71-213" aria-hidden="true" tabindex="-1"></a><span class="fu">environment</span>(function_name)</span>
<span id="cb71-214"><a href="#cb71-214" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-215"><a href="#cb71-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-216"><a href="#cb71-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-217"><a href="#cb71-217" aria-hidden="true" tabindex="-1"></a>Also note, <span class="in">`function()`</span> is a very weird function, since the body argument goes outside the parentheses! Technically even the example above is a real function (albeit a boring one).</span>
<span id="cb71-218"><a href="#cb71-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-219"><a href="#cb71-219" aria-hidden="true" tabindex="-1"></a>Better example of simple function for adding up two numbers.</span>
<span id="cb71-220"><a href="#cb71-220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-221"><a href="#cb71-221" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Give functions a name that indicate what it does (intuitive names help a great deal with readable code).</span>
<span id="cb71-222"><a href="#cb71-222" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-223"><a href="#cb71-223" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Style guide: Can use the assignment arrow <span class="in">`&lt;-`</span> for anytime something will be saved to the global environment (data values and functions), but within a function we can use <span class="in">`=`</span> because it is only found locally and is temporary.</span>
<span id="cb71-224"><a href="#cb71-224" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-225"><a href="#cb71-225" aria-hidden="true" tabindex="-1"></a><span class="ss">    - </span><span class="in">`&lt;&lt;-`</span> Assigns values from a local environment (like a function call) and saves it in the global environment (this is a really bad idea because it could overwrite something that you already have in the global environment)</span>
<span id="cb71-226"><a href="#cb71-226" aria-hidden="true" tabindex="-1"></a>    </span>
<span id="cb71-227"><a href="#cb71-227" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>Returning values: Functions implicitly return the last thing computed. So it is often a good idea to be explicit about what to return.</span>
<span id="cb71-228"><a href="#cb71-228" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-231"><a href="#cb71-231" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-232"><a href="#cb71-232" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: defining-functions-assignment</span></span>
<span id="cb71-233"><a href="#cb71-233" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-234"><a href="#cb71-234" aria-hidden="true" tabindex="-1"></a><span class="co"># write function add two numbers</span></span>
<span id="cb71-235"><a href="#cb71-235" aria-hidden="true" tabindex="-1"></a>my_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb71-236"><a href="#cb71-236" aria-hidden="true" tabindex="-1"></a>  val <span class="ot">=</span> x <span class="sc">+</span> y</span>
<span id="cb71-237"><a href="#cb71-237" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(val)</span>
<span id="cb71-238"><a href="#cb71-238" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-239"><a href="#cb71-239" aria-hidden="true" tabindex="-1"></a><span class="fu">my_sum</span>(<span class="dv">1</span>,<span class="dv">2</span>)</span>
<span id="cb71-240"><a href="#cb71-240" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-241"><a href="#cb71-241" aria-hidden="true" tabindex="-1"></a><span class="co"># bad idea</span></span>
<span id="cb71-242"><a href="#cb71-242" aria-hidden="true" tabindex="-1"></a>my_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y){</span>
<span id="cb71-243"><a href="#cb71-243" aria-hidden="true" tabindex="-1"></a>  val <span class="ot">&lt;&lt;-</span> x <span class="sc">+</span> y</span>
<span id="cb71-244"><a href="#cb71-244" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(val)</span>
<span id="cb71-245"><a href="#cb71-245" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-246"><a href="#cb71-246" aria-hidden="true" tabindex="-1"></a><span class="co"># val isn't in the global environment</span></span>
<span id="cb71-247"><a href="#cb71-247" aria-hidden="true" tabindex="-1"></a><span class="fu">my_sum</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb71-248"><a href="#cb71-248" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-249"><a href="#cb71-249" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-250"><a href="#cb71-250" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-251"><a href="#cb71-251" aria-hidden="true" tabindex="-1"></a>More complex functions: In a legitimate function, to have our function behave differently, we can use some if and else statements that are usually triggered by a yes / no or true / false.</span>
<span id="cb71-252"><a href="#cb71-252" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-255"><a href="#cb71-255" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-256"><a href="#cb71-256" aria-hidden="true" tabindex="-1"></a><span class="co"># label: defining-functions-ifs</span></span>
<span id="cb71-257"><a href="#cb71-257" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-258"><a href="#cb71-258" aria-hidden="true" tabindex="-1"></a><span class="co"># now trying to do something cool (and / or breaking it)</span></span>
<span id="cb71-259"><a href="#cb71-259" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; on rare occasions, add some random error to the sum</span></span>
<span id="cb71-260"><a href="#cb71-260" aria-hidden="true" tabindex="-1"></a>my_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">mischief =</span> <span class="cn">TRUE</span>){</span>
<span id="cb71-261"><a href="#cb71-261" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(mischief <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb71-262"><a href="#cb71-262" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">=</span> x <span class="sc">+</span> y</span>
<span id="cb71-263"><a href="#cb71-263" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb71-264"><a href="#cb71-264" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">=</span> x <span class="sc">+</span> y <span class="sc">+</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">02</span>,.<span class="dv">96</span>,.<span class="dv">02</span>))</span>
<span id="cb71-265"><a href="#cb71-265" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-266"><a href="#cb71-266" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(val)</span>
<span id="cb71-267"><a href="#cb71-267" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-268"><a href="#cb71-268" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-269"><a href="#cb71-269" aria-hidden="true" tabindex="-1"></a><span class="co"># run the function 100 times using specified values for the arguments</span></span>
<span id="cb71-270"><a href="#cb71-270" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; not using the X in our function call</span></span>
<span id="cb71-271"><a href="#cb71-271" aria-hidden="true" tabindex="-1"></a><span class="fu">sapply</span>(<span class="at">X =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>, my_sum, <span class="at">x =</span> <span class="dv">1</span>, <span class="at">y =</span> <span class="dv">2</span>)</span>
<span id="cb71-272"><a href="#cb71-272" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-273"><a href="#cb71-273" aria-hidden="true" tabindex="-1"></a><span class="co"># equivalent to</span></span>
<span id="cb71-274"><a href="#cb71-274" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">100</span>) {</span>
<span id="cb71-275"><a href="#cb71-275" aria-hidden="true" tabindex="-1"></a>  <span class="fu">print</span>(<span class="fu">my_sum</span>(<span class="dv">1</span>, <span class="dv">2</span>))</span>
<span id="cb71-276"><a href="#cb71-276" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-277"><a href="#cb71-277" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-278"><a href="#cb71-278" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-279"><a href="#cb71-279" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-280"><a href="#cb71-280" aria-hidden="true" tabindex="-1"></a>Can return something more complex than just a data value by returning lists. Functions that output lists are kinda the next step of complex computing ideas.</span>
<span id="cb71-281"><a href="#cb71-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-284"><a href="#cb71-284" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-285"><a href="#cb71-285" aria-hidden="true" tabindex="-1"></a><span class="co"># label: defining-functions-return-list</span></span>
<span id="cb71-286"><a href="#cb71-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-287"><a href="#cb71-287" aria-hidden="true" tabindex="-1"></a><span class="co"># modify function to return a list with multiple objects in it</span></span>
<span id="cb71-288"><a href="#cb71-288" aria-hidden="true" tabindex="-1"></a>my_sum <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y, <span class="at">mischief =</span> <span class="cn">TRUE</span>){</span>
<span id="cb71-289"><a href="#cb71-289" aria-hidden="true" tabindex="-1"></a>  <span class="cf">if</span>(mischief <span class="sc">==</span> <span class="cn">FALSE</span>){</span>
<span id="cb71-290"><a href="#cb71-290" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">=</span> x <span class="sc">+</span> y</span>
<span id="cb71-291"><a href="#cb71-291" aria-hidden="true" tabindex="-1"></a>  } <span class="cf">else</span> {</span>
<span id="cb71-292"><a href="#cb71-292" aria-hidden="true" tabindex="-1"></a>    val <span class="ot">=</span> x <span class="sc">+</span> y <span class="sc">+</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>,<span class="dv">0</span>,<span class="dv">1</span>), <span class="at">size =</span> <span class="dv">1</span>, <span class="at">prob =</span> <span class="fu">c</span>(.<span class="dv">02</span>,.<span class="dv">96</span>,.<span class="dv">02</span>))</span>
<span id="cb71-293"><a href="#cb71-293" aria-hidden="true" tabindex="-1"></a>  }</span>
<span id="cb71-294"><a href="#cb71-294" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">value =</span> val,</span>
<span id="cb71-295"><a href="#cb71-295" aria-hidden="true" tabindex="-1"></a>              <span class="at">mischief =</span> mischief))</span>
<span id="cb71-296"><a href="#cb71-296" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-297"><a href="#cb71-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-298"><a href="#cb71-298" aria-hidden="true" tabindex="-1"></a><span class="fu">my_sum</span>(<span class="dv">1</span>, <span class="dv">2</span>)</span>
<span id="cb71-299"><a href="#cb71-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-300"><a href="#cb71-300" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-301"><a href="#cb71-301" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-302"><a href="#cb71-302" aria-hidden="true" tabindex="-1"></a><span class="in">`sapply()`</span> is a function that calls other functions in an iterative way (really efficient for loop).</span>
<span id="cb71-303"><a href="#cb71-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-304"><a href="#cb71-304" aria-hidden="true" tabindex="-1"></a><span class="fu">### Calling a Function</span></span>
<span id="cb71-305"><a href="#cb71-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-306"><a href="#cb71-306" aria-hidden="true" tabindex="-1"></a>To call a function, you simply use its name and define any required formal arguments. Typically this is done within a set of parentheses directly following the function name. Only a few special cases break from that pattern. </span>
<span id="cb71-307"><a href="#cb71-307" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-308"><a href="#cb71-308" aria-hidden="true" tabindex="-1"></a>What is more important to focus on is **if** and **how** we define the arguments. We may choose to define nothing in the arguments and the function might still work. </span>
<span id="cb71-309"><a href="#cb71-309" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-312"><a href="#cb71-312" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-313"><a href="#cb71-313" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: args-null</span></span>
<span id="cb71-314"><a href="#cb71-314" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb71-315"><a href="#cb71-315" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-316"><a href="#cb71-316" aria-hidden="true" tabindex="-1"></a><span class="co"># write function that has no arguments to simply return this hardcoded value</span></span>
<span id="cb71-317"><a href="#cb71-317" aria-hidden="true" tabindex="-1"></a>no_arg <span class="ot">&lt;-</span> <span class="cf">function</span>(){</span>
<span id="cb71-318"><a href="#cb71-318" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb71-319"><a href="#cb71-319" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb71-320"><a href="#cb71-320" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-321"><a href="#cb71-321" aria-hidden="true" tabindex="-1"></a><span class="fu">no_arg</span>()</span>
<span id="cb71-322"><a href="#cb71-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-323"><a href="#cb71-323" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; so it will generate an error if we tried to give it an argument that isn't defined in the function</span></span>
<span id="cb71-324"><a href="#cb71-324" aria-hidden="true" tabindex="-1"></a><span class="fu">no_arg</span>(<span class="at">x =</span> <span class="dv">20</span>)</span>
<span id="cb71-325"><a href="#cb71-325" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-326"><a href="#cb71-326" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-327"><a href="#cb71-327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-328"><a href="#cb71-328" aria-hidden="true" tabindex="-1"></a>Typically these are made more flexible using dots <span class="in">`...`</span>. All this does is put the values into the local namespace and continues running the function. These are optional arguments.</span>
<span id="cb71-329"><a href="#cb71-329" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-332"><a href="#cb71-332" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-333"><a href="#cb71-333" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: args-dots</span></span>
<span id="cb71-334"><a href="#cb71-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-335"><a href="#cb71-335" aria-hidden="true" tabindex="-1"></a><span class="co"># define function wtih ... formal</span></span>
<span id="cb71-336"><a href="#cb71-336" aria-hidden="true" tabindex="-1"></a>no_arg2 <span class="ot">&lt;-</span> <span class="cf">function</span>(...){</span>
<span id="cb71-337"><a href="#cb71-337" aria-hidden="true" tabindex="-1"></a>  x <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb71-338"><a href="#cb71-338" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb71-339"><a href="#cb71-339" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-340"><a href="#cb71-340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-341"><a href="#cb71-341" aria-hidden="true" tabindex="-1"></a><span class="co"># functions works with no arguments</span></span>
<span id="cb71-342"><a href="#cb71-342" aria-hidden="true" tabindex="-1"></a><span class="fu">no_arg2</span>() </span>
<span id="cb71-343"><a href="#cb71-343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-344"><a href="#cb71-344" aria-hidden="true" tabindex="-1"></a><span class="co"># and now with arguments</span></span>
<span id="cb71-345"><a href="#cb71-345" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; it initializes the value of x, but then  overwrites the value of x internally</span></span>
<span id="cb71-346"><a href="#cb71-346" aria-hidden="true" tabindex="-1"></a><span class="fu">no_arg2</span>(<span class="at">x =</span> <span class="dv">20</span>)</span>
<span id="cb71-347"><a href="#cb71-347" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-348"><a href="#cb71-348" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-349"><a href="#cb71-349" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-350"><a href="#cb71-350" aria-hidden="true" tabindex="-1"></a>For "optional" arguments (arguments that sometimes matters and sometimes don't matter), we should define them as formal parameters with some default values. This way we can override them if we wanted to.</span>
<span id="cb71-351"><a href="#cb71-351" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-354"><a href="#cb71-354" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-355"><a href="#cb71-355" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: args-defaults</span></span>
<span id="cb71-356"><a href="#cb71-356" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-357"><a href="#cb71-357" aria-hidden="true" tabindex="-1"></a><span class="co"># add default value to argument</span></span>
<span id="cb71-358"><a href="#cb71-358" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; now it behaves typically how we want, but can change them if we want</span></span>
<span id="cb71-359"><a href="#cb71-359" aria-hidden="true" tabindex="-1"></a>no_arg3 <span class="ot">&lt;-</span> <span class="cf">function</span>(<span class="at">x =</span> <span class="dv">10</span>){</span>
<span id="cb71-360"><a href="#cb71-360" aria-hidden="true" tabindex="-1"></a>  <span class="fu">return</span>(x)</span>
<span id="cb71-361"><a href="#cb71-361" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-362"><a href="#cb71-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-363"><a href="#cb71-363" aria-hidden="true" tabindex="-1"></a><span class="co"># this is the behavior we typically will want</span></span>
<span id="cb71-364"><a href="#cb71-364" aria-hidden="true" tabindex="-1"></a><span class="fu">no_arg3</span>()</span>
<span id="cb71-365"><a href="#cb71-365" aria-hidden="true" tabindex="-1"></a><span class="fu">no_arg3</span>(<span class="at">x =</span> <span class="dv">20</span>)</span>
<span id="cb71-366"><a href="#cb71-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-367"><a href="#cb71-367" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-368"><a href="#cb71-368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-369"><a href="#cb71-369" aria-hidden="true" tabindex="-1"></a>The more important characteristics of function calls are related to how we define our arguments: implicitly and explicitly. If we rely on the default ordering of the arguements, then we are calling the arguments *implicitly*. If we refer to the argument by it's name while defining the values, then we are calling the argument *explicitly*. Often we use a mix of these methods, but it is important to be aware of how and why we choose to define our arguments.</span>
<span id="cb71-370"><a href="#cb71-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-371"><a href="#cb71-371" aria-hidden="true" tabindex="-1"></a>A function runs through all of the named arguments, then goes in order for the unnamed arguments.</span>
<span id="cb71-372"><a href="#cb71-372" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-375"><a href="#cb71-375" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-376"><a href="#cb71-376" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: arg_exp_implicit</span></span>
<span id="cb71-377"><a href="#cb71-377" aria-hidden="true" tabindex="-1"></a><span class="co">#| error: true</span></span>
<span id="cb71-378"><a href="#cb71-378" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-379"><a href="#cb71-379" aria-hidden="true" tabindex="-1"></a><span class="co"># all of the following are equivalent</span></span>
<span id="cb71-380"><a href="#cb71-380" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-381"><a href="#cb71-381" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>, <span class="at">na.rm =</span> <span class="cn">TRUE</span>)</span>
<span id="cb71-382"><a href="#cb71-382" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="at">na.rm =</span> <span class="cn">TRUE</span>, <span class="at">x =</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb71-383"><a href="#cb71-383" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-384"><a href="#cb71-384" aria-hidden="true" tabindex="-1"></a><span class="co"># the following is NOT equivalent</span></span>
<span id="cb71-385"><a href="#cb71-385" aria-hidden="true" tabindex="-1"></a><span class="co"># -&gt; it is expecting a numeric first</span></span>
<span id="cb71-386"><a href="#cb71-386" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="cn">TRUE</span>, <span class="dv">1</span><span class="sc">:</span><span class="dv">5</span>)</span>
<span id="cb71-387"><a href="#cb71-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-388"><a href="#cb71-388" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb71-389"><a href="#cb71-389" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-390"><a href="#cb71-390" aria-hidden="true" tabindex="-1"></a>Possible convention: Implicitly give the function data values first, then use explicit calling for the options (this will still be readable because the function name will indicate what it's going to do with the data values).</span>
<span id="cb71-391"><a href="#cb71-391" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-392"><a href="#cb71-392" aria-hidden="true" tabindex="-1"></a><span class="fu">### Automating procedures</span></span>
<span id="cb71-393"><a href="#cb71-393" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-394"><a href="#cb71-394" aria-hidden="true" tabindex="-1"></a>The following example demonstrates code that would be better served by constructing a function to accomplish the task.</span>
<span id="cb71-395"><a href="#cb71-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-398"><a href="#cb71-398" aria-hidden="true" tabindex="-1"></a><span class="in">```{r}</span></span>
<span id="cb71-399"><a href="#cb71-399" aria-hidden="true" tabindex="-1"></a><span class="co">#| label: example-change-to-functions</span></span>
<span id="cb71-400"><a href="#cb71-400" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-401"><a href="#cb71-401" aria-hidden="true" tabindex="-1"></a><span class="co"># take the following olive oil data and standardize the columns</span></span>
<span id="cb71-402"><a href="#cb71-402" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(pdfCluster) <span class="co"># for the data</span></span>
<span id="cb71-403"><a href="#cb71-403" aria-hidden="true" tabindex="-1"></a><span class="fu">data</span>(oliveoil) <span class="co"># ?oliveoil</span></span>
<span id="cb71-404"><a href="#cb71-404" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-405"><a href="#cb71-405" aria-hidden="true" tabindex="-1"></a><span class="co"># start with a dataframe where create the z-scores for palmitic acid, then add the rest </span></span>
<span id="cb71-406"><a href="#cb71-406" aria-hidden="true" tabindex="-1"></a>oo_standardized <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-407"><a href="#cb71-407" aria-hidden="true" tabindex="-1"></a>  <span class="at">palmitic =</span> (oliveoil[,<span class="st">"palmitic"</span>]<span class="sc">-</span><span class="fu">mean</span>(oliveoil[,<span class="st">"palmitic"</span>]))<span class="sc">/</span><span class="fu">sd</span>(oliveoil[,<span class="st">"palmitic"</span>])</span>
<span id="cb71-408"><a href="#cb71-408" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-409"><a href="#cb71-409" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(oo_standardized)</span>
<span id="cb71-410"><a href="#cb71-410" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-411"><a href="#cb71-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-412"><a href="#cb71-412" aria-hidden="true" tabindex="-1"></a><span class="co"># do this better with a function, rather than copy and paste and change column names</span></span>
<span id="cb71-413"><a href="#cb71-413" aria-hidden="true" tabindex="-1"></a>oo_standardized2 <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(</span>
<span id="cb71-414"><a href="#cb71-414" aria-hidden="true" tabindex="-1"></a>  <span class="at">oleic =</span> (oliveoil[,<span class="st">"oleic"</span>]<span class="sc">-</span><span class="fu">mean</span>(oliveoil[,<span class="st">"oleic"</span>]))<span class="sc">/</span><span class="fu">sd</span>(oliveoil[,<span class="st">"oleic"</span>])</span>
<span id="cb71-415"><a href="#cb71-415" aria-hidden="true" tabindex="-1"></a>)</span>
<span id="cb71-416"><a href="#cb71-416" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(oo_standardized2)</span>
<span id="cb71-417"><a href="#cb71-417" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-418"><a href="#cb71-418" aria-hidden="true" tabindex="-1"></a><span class="co"># write function to take a variable name and return the standardized column</span></span>
<span id="cb71-419"><a href="#cb71-419" aria-hidden="true" tabindex="-1"></a>oo_stand <span class="ot">&lt;-</span> <span class="cf">function</span>(varname) {</span>
<span id="cb71-420"><a href="#cb71-420" aria-hidden="true" tabindex="-1"></a>  (oliveoil[,varname]<span class="sc">-</span><span class="fu">mean</span>(oliveoil[,varname]))<span class="sc">/</span><span class="fu">sd</span>(oliveoil[,varname])</span>
<span id="cb71-421"><a href="#cb71-421" aria-hidden="true" tabindex="-1"></a>}</span>
<span id="cb71-422"><a href="#cb71-422" aria-hidden="true" tabindex="-1"></a><span class="fu">head</span>(<span class="fu">oo_stand</span>(<span class="st">"palmitic"</span>))</span>
<span id="cb71-423"><a href="#cb71-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-424"><a href="#cb71-424" aria-hidden="true" tabindex="-1"></a><span class="co"># loop over all column names with sapply()</span></span>
<span id="cb71-425"><a href="#cb71-425" aria-hidden="true" tabindex="-1"></a>oo_standardized3 <span class="ot">&lt;-</span> <span class="fu">sapply</span>(<span class="at">X =</span> <span class="fu">names</span>(oliveoil)[<span class="dv">3</span><span class="sc">:</span><span class="dv">10</span>], <span class="at">FUN =</span> oo_stand)</span>
<span id="cb71-426"><a href="#cb71-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb71-427"><a href="#cb71-427" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
</code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->



</body></html>